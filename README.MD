## PC DWH

Реализация проекта по контролю комплектующих на предприятии по сбору компьютеров.  
В соответствии с [заданием](https://github.com/Imato/PC_DWH/blob/master/Description/specification.md).

### Содержание 

- [Backup готовой базы данных](https://github.com/Imato/PC_DWH/tree/master/DB)
- [Проект базы данных](https://github.com/Imato/PC_DWH/tree/master/Project/PC_DWH/Database/Database)
- [Проект отчетов](https://github.com/Imato/PC_DWH/tree/master/Project/PC_DWH/RS/RS)

### Описание и схема базы данных

Схема DWH представляет собой "снежинку".

Измерения:  
* **dim_supplier** - поставщики оборудования
* **dim_hardware** - комплектующие
* **dim_hardware_type** - типы комплектующих
* **dim_model** - модели выпускаемых компьютеров
* **dim_customer** - покупатели (необязательно для задания)
* **dim_purchase** - уникальный номер закупки (для контроля целостности, не обязательно в задании)

Факты:
* **fact_purchase** - закупка комплектующих (не обязательно в задании), необходим для выяснения закупочной цены комплектующих
* **fact_manufacture** - производство компьютеров из комплектующих
* **fact_sales** - реализация компьютеров
* **fact_return** - возвраты бракованных компьютеров клиентами

Связи между таблицами можно посмотреть на [схеме](https://github.com/Imato/PC_DWH/blob/master/Description/Pic/pic_001.png)

![pic 001](https://github.com/Imato/PC_DWH/blob/master/Description/Pic/pic_001.png)

Описание базы данных:  
В простейшем виде создана цепочка "закупки-производство-продажи". При этом "закупка" не является необходимой и присутствует для последующего контроля стоимости комплектующих по номеру партии (purchase_id) в производстве. Предполагается, что компьютер будет отслеживаться по уникальному номеру serial_id, генерируемому на этапе производства, затем этот номер проходит в реализации и возвратах. В проекте не реализована логика контроля и обновления стоимости комплектующих и товара (компьютера) на всех цепочках.    
Для таблиц проведена достаточная оптимизация - сегментация и создание индексов, необходимых для итогового отчета. Сегментация организованна лишь для части предполагаемых значений индекса.  
Витрина данных для построения отчетов реализована через схему rs и представлена тремя вью: [rs].[dim_hardware], [rs].[fact_manufacture], [rs].[fact_return], [rs].[fact_sales].  
Для более детального ознакомления со структурой базы рекомендуется восстановить её из [backup](https://github.com/Imato/PC_DWH/tree/master/DB)

### Отчет

Процедура выполнения отчета: [rs.prc_r_001](https://github.com/Imato/PC_DWH/blob/master/Project/PC_DWH/Database/Database/Procedures/rs/prc_r_001.sql).  
Определение отчета в проекте [r_001.rdl](https://github.com/Imato/PC_DWH/blob/master/Project/PC_DWH/RS/RS/r_001.rdl).   

Коментарии:   
Срок службы комплектующих вычисляется **в днях до указанной в отчете даты** (по-умолчанию, текущей). При возврате компьютера покупателю возвращается вся стоимость компьютера и предполагается, что компания несет убытки на стоимость комплектующих. 

### Что не реализованно

1. Заполнение базы данными и проверка производительности и планов запроса на больших массивах
2. Нет тестового проекта по проверке отчета r_001 на данных.
